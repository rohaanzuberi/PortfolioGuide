(this["webpackJsonp@dcmfe/mfe-app-workspace"]=this["webpackJsonp@dcmfe/mfe-app-workspace"]||[]).push([[90],{"./src/notebookViewer/WrappedNotebookViewer.tsx":function(e,t,n){"use strict";n.r(t);var a=n("../../node_modules/@babel/runtime/helpers/defineProperty.js"),s=n.n(a),o=n("../../node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),c=n.n(o),r=n("../../node_modules/@babel/runtime/helpers/slicedToArray.js"),l=n.n(r),i=(n("../../node_modules/prop-types/index.js"),n("../../node_modules/@datacamp/waffles/esm/tokens/tokens.js")),d=n("../../node_modules/@nteract/commutable/lib/index.js"),u=n("../../node_modules/lodash.clonedeep/index.js"),b=n.n(u),m=n("react"),p=function(e){var t,n,a=null===(t=e.metadata.get("kernelspec"))||void 0===t?void 0:t.get("language"),s=null===(n=e.metadata.get("jupytext"))||void 0===n?void 0:n.get("main_language");return null!==a&&void 0!==a?a:s},g=n("../../libs/components/collab-publications/dist/es/styles.js"),h=n("../../libs/components/collab-publications/dist/es/components/AnyCell.js"),j=n("../../libs/components/collab-publications/dist/es/components/NotebookViewerProvider.js"),f=n("../../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js"),O=function(e){var t,n=e.CellWrapper,a=e.className,o=e.notebook,c=e.syntaxHighlighterLanguage,r=e.workspaceId;return Object(f.b)("div",{className:a,css:[(t={"& > *":{margin:"0 !important"}},s()(t,g.d.tablet,{paddingTop:0}),s()(t,"p",{wordBreak:"break-word"}),s()(t,"paddingTop",i.a.spacing.large),t),"",""],children:o.cellOrder.map((function(e){return[e,o.cellMap.get(e)]})).map((function(e){var t=l()(e,2),a=t[0],s=t[1];if(null==s)return null;var o=s.metadata.get("jupyter");return!0===(null===o||void 0===o?void 0:o.outputs_hidden)&&!0===(null===o||void 0===o?void 0:o.source_hidden)?null:null==n?Object(f.b)(h.a,{cell:s,cellId:a,syntaxHighlighterLanguage:c},a):Object(f.b)(n,{cellId:a,workspaceId:r,children:Object(f.b)(h.a,{cell:s,cellId:a,syntaxHighlighterLanguage:c})},a)}))})};O.propTypes={};var v=function(e){var t,n=e.className,a=e.notebook,s=Object(m.useMemo)((function(){return Object(d.fromJS)(b()(a))}),[a]),o=Object(j.b)(),c=o.CellWrapper,r=o.syntaxHighlighterLanguage,l=o.workspaceId;return Object(f.b)(O,{CellWrapper:c,className:n,notebook:s,syntaxHighlighterLanguage:(null!==(t=null!==r&&void 0!==r?r:p(s))&&void 0!==t?t:"").toLowerCase(),workspaceId:l})};v.propTypes={};var x=["className","notebook"];function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k=function(e){var t=e.className,n=e.notebook,a=c()(e,x);return Object(f.b)(j.a,w(w({},a),{},{children:Object(f.b)(v,{className:t,notebook:n})}))},C=n("../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),_=n("../../libs/shared/domain/dist/es/domains/commenting/domain.js"),I=n("../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty.js"),S=n("../../node_modules/@datacamp/waffles/esm/icon/chat.js"),D=n("../../node_modules/@datacamp/waffles-button/es/index.js"),M=n("../../node_modules/@datacamp/waffles-utils/es/index.js"),T=n("../../node_modules/react-cool-onclickoutside/dist/index.esm.js"),L=n("./src/styles.ts"),z=n("./src/useLinkClick.tsx"),P=n("../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),E=n("../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),R=n("../../libs/shared/domain/dist/es/types/PII.js"),F=n("../../node_modules/fp-ts/es6/index.js"),N=n("../../node_modules/stream-chat-react/dist/context/MessageInputContext.js"),A=n("../../node_modules/stream-chat-react/dist/components/Channel/Channel.js"),B=n("../../node_modules/stream-chat-react/dist/components/MessageList/MessageList.js"),W=n("../../node_modules/stream-chat-react/dist/components/MessageInput/MessageInput.js"),H=n("./src/api/collabApi.ts"),U=n("./src/publicProfile/Avatar.tsx"),G=n("./src/sentry.ts"),V=n("../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator/index.js"),J=n.n(V),q=n("../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),Y=n("../../node_modules/@datacamp/waffles/esm/text/text.js"),K=n("../../node_modules/@datacamp/waffles-text/es/components/Link.js"),Q=n("../../node_modules/@datacamp/waffles-toast/es/index.js"),X=n("../../node_modules/stream-chat-react/dist/context/ChatContext.js"),Z=n("../../node_modules/stream-chat-react/dist/components/Message/hooks/useFlagHandler.js"),$=n("../../node_modules/stream-chat-react/dist/components/Message/MessageText.js"),ee=n("../../node_modules/stream-chat-react/dist/context/MessageContext.js"),te=n("../../node_modules/stream-chat-react/dist/components/Message/hooks/useEditHandler.js"),ne=n("./src/config.ts"),ae=n("./src/redact.ts"),se=n("../../node_modules/@datacamp/waffles/esm/icon/more.js"),oe=n("../../node_modules/@datacamp/waffles/esm/icon/edit.js"),ce=n("../../node_modules/@datacamp/waffles/esm/icon/trash.js"),re=n("../../node_modules/@datacamp/waffles/esm/icon/forbidden.js"),le=n("../../node_modules/@datacamp/waffles-card/es/index.js"),ie=n("./src/dropdown/index.tsx"),de=n("./src/dropdown/getDropdownStyle.tsx"),ue=n("./src/dropdown/useDropdown.ts"),be=function(e){var t=e.onDelete,n=e.onEdit,a=e.onFlag,s=Object(ue.a)({position:"bottomRight"}),o=s.dropdownButtonRef,c=s.dropdownRef,r=s.dropdownStyle,l=s.toggleDropdown;return Object(f.c)(f.a,{children:[Object(f.b)(D.g,{ariaLabel:"comment options",css:{"&:hover":{color:i.a.colors.navy},backgroundColor:"transparent !important",border:"none",color:i.a.colors.navySubtleTextOnLight,padding:i.a.spacing.xsmall},onClick:l,ref:o,size:"small",children:Object(f.b)(se.a,{css:{marginLeft:i.a.spacing.xsmall},size:"small"})}),Object(f.b)("div",{ref:c,children:Object(f.b)(le.a,{css:[r,{button:{padding:"".concat(i.a.spacing.xsmall," ").concat(i.a.spacing.medium," ")},overflow:"hidden",padding:"".concat(i.a.spacing.small," 0"),zIndex:2}],elevation:3,children:Object(f.c)("ul",{css:Object(de.a)(),children:[null!=n&&Object(f.b)(ie.b,{Icon:oe.a,action:{onClick:F.c.flow(n,l),type:"callback-old"},children:"Edit comment"}),null!=t&&Object(f.b)(ie.b,{Icon:ce.a,action:{onClick:F.c.flow(t,l),type:"callback-old"},intent:"danger",children:"Delete comment"}),null!=a&&Object(f.b)(ie.b,{Icon:re.a,action:{onClick:F.c.flow(a,l),type:"callback-old"},children:"Report comment"})]})})})]})},me=n("./src/commenting/contexts/usePublicationCommenting.ts"),pe=n("../../node_modules/stream-chat-react/dist/components/ChatAutoComplete/ChatAutoComplete.js"),ge=n("./src/util/noop.ts"),he=function(){var e,t=Object(ee.b)().message,n=Object(N.b)(),a=n.clearEditingState,s=n.handleSubmit,o=n.text,c=Object(m.useCallback)((function(e){null!=e&&s(e)}),[s]);return Object(f.c)("div",{css:{".str-chat__textarea__textarea":{fontFamily:i.a.fontFamilies.sansSerif,fontSize:i.a.fontSizes.medium,padding:i.a.spacing.xsmall,resize:"none",width:"100%"},width:"100%"},children:[Object(f.c)("div",{css:{".str-chat__textarea":{flexGrow:1,zIndex:i.a.zIndex.default},alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"flex-start"},children:[Object(f.b)(U.a,{avatar:Object(R.a)(null===(e=t.user)||void 0===e?void 0:e.image),css:{marginBottom:6},dimensions:20}),Object(f.b)(pe.a,{})]}),Object(f.c)("div",{css:{alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"flex-end"},children:[Object(f.b)(D.g,{appearance:"primary",css:{"&:hover":{backgroundColor:"transparent",border:"none",span:{color:i.a.colors.blue}},backgroundColor:"transparent",border:"none",height:i.a.sizing.small,marginRight:i.a.spacing.xsmall,padding:"".concat(i.a.spacing.xsmall," ").concat(i.a.spacing.small),span:{color:i.a.colors.blueDarkText}},intent:"neutral",onClick:null==a?ge.a:a,size:"small",children:"Cancel"}),Object(f.b)(D.g,{appearance:"primary",css:{height:i.a.sizing.small,padding:"".concat(i.a.spacing.xsmall," ").concat(i.a.spacing.small)},disabled:""===o,intent:"success",onClick:c,size:"small",children:"Save Changes"})]})]})},je=864e5,fe=function(e){var t,n,a,s,o=e.message,c=e.setEdit,r=Object(X.b)().client,l=Object(Z.a)(o,{notify:function(){return Object(Q.b)({intent:"success",title:"Message reported"})}}),d=Object(m.useCallback)(Object(q.a)(J.a.mark((function e(){return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.deleteMessage(o.id,!0);case 3:Object(Q.b)({intent:"success",title:"Message deleted"}),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),Object(Q.b)({intent:"error",title:"Failed to delete the message, please retry."});case 9:case"end":return e.stop()}}),e,null,[[0,6]])}))),[o,r]),u=Object(m.useState)(),b=Object(C.a)(u,2),p=b[0],g=b[1],h=Object(m.useMemo)((function(){return null==o.created_at?null:new Date(o.created_at).toLocaleString()}),[o.created_at]);Object(m.useEffect)((function(){var e=function(){if(null!=o.created_at){var e=new Date(o.created_at);g(function(e){var t=new Date(e),n=t.getDate(),a=t.toLocaleString("en-US",{hour:"2-digit",hour12:!0,minute:"2-digit"}).toLocaleUpperCase(),s=new Date,o=s.getTime()-je,c=o-je,r=new Date;return r.setDate(r.getDate()-1),e>o&&n===s.getDate()?"Today, ".concat(a):e>c&&n===r.getDate()?"Yesterday, ".concat(a):"".concat(t.toLocaleString("default",{month:"short"})," ").concat(t.getUTCDate(),", ").concat(a)}(e.getTime()))}};e();var t=setInterval(e,1e4);return function(){return clearInterval(t)}}),[o.created_at]);var j,O,v=null!=r.user&&(null===(t=o.user)||void 0===t?void 0:t.id)===r.user.id;return Object(f.c)(f.a,{children:[Object(f.c)("div",{css:{alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"flex-start"},children:[Object(f.b)(U.a,{avatar:Object(R.a)(null===(n=o.user)||void 0===n?void 0:n.image),dimensions:20}),null!=o.user&&Object(f.b)(K.a,{css:{fontWeight:i.a.fontWeights.bold,marginRight:i.a.spacing.small},dataAttributes:Object(ae.a)({attributes:["href"],text:!0}).dataAttributes,href:"".concat(ne.a.urls.datacamp,"/profile/").concat(o.user.name),children:null!==(a=null!==(s=o.user.fullName)&&void 0!==s?s:o.user.name)&&void 0!==a?a:""}),null!=h&&Object(f.b)("time",{css:{color:i.a.colors.navySubtleTextOnLight},dateTime:h,title:h,children:p}),(j=o.created_at,O=o.updated_at,!(null==j||null==O?j===O:new Date(j).getTime()===new Date(O).getTime())&&Object(f.b)(Y.a,{css:{color:i.a.colors.navySubtleTextOnDark,marginLeft:i.a.spacing.xsmall},children:"(edited)"}))]}),Object(f.b)("div",{css:{marginLeft:28,ol:{listStyleType:"decimal",paddingInlineStart:i.a.spacing.medium},overflowWrap:"anywhere",p:{marginBottom:0,marginTop:0},ul:{listStyleType:"circle",paddingInlineStart:i.a.spacing.medium}},children:Object(f.b)($.a,{})}),Object(f.b)("div",{css:{position:"absolute",right:0,top:0},children:Object(f.b)(be,{onDelete:v?d:void 0,onEdit:v?c:void 0,onFlag:v?void 0:l})})]})},Oe=function(e){var t=e.clearEdit,n=e.message,a=Object(me.a)();return Object(f.b)(W.a,{Input:he,additionalTextareaProps:a.canComment?{maxLength:a.maxMessageLength}:{},clearEditingState:t,disableMentions:!0,focus:!0,grow:!0,message:n})},ve=function(){var e=Object(ee.b)().message,t=Object(te.a)(),n=t.clearEdit,a=t.editing,s=t.setEdit;return Object(f.b)("div",{css:{alignItems:"flex-start",display:"flex",flexDirection:"column",fontFamily:"".concat(i.a.fontFamilies.sansSerif," !important"),justifyContent:"center",marginBottom:i.a.spacing.small,position:"relative"},children:a?Object(f.b)(Oe,{clearEdit:n,message:e}):Object(f.b)(fe,{message:e,setEdit:s})})},xe=n("../../node_modules/react/jsx-runtime.js"),ye=Object(m.createContext)({onCancelMessageInput:null,showControls:!0}),we=function(e){var t=e.children,n=e.onCancelMessageInput,a=e.showControls,s=Object(m.useMemo)((function(){return{onCancelMessageInput:null==n?null:n,showControls:null==a||a}}),[n,a]);return Object(xe.jsx)(ye.Provider,{value:s,children:t})},ke=function(){var e,t=Object(N.b)(),n=t.handleSubmit,a=t.setText,s=t.text,o=Object(m.useContext)(ye),c=o.onCancelMessageInput,r=o.showControls,l=Object(m.useCallback)((function(e){null!=e&&n(e)}),[n]),d=Object(X.b)().client;return Object(f.c)("div",{css:{".str-chat__textarea__textarea":{fontFamily:i.a.fontFamilies.sansSerif,fontSize:i.a.fontSizes.medium,padding:i.a.spacing.xsmall,resize:"none",width:"100%"}},children:[Object(f.c)("div",{css:{".str-chat__textarea":{flexGrow:1,zIndex:i.a.zIndex.default},alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"flex-start"},children:[Object(f.b)(U.a,{avatar:Object(R.a)(null===(e=d.user)||void 0===e?void 0:e.image),css:{marginBottom:6},dimensions:20}),Object(f.b)(pe.a,{})]}),r&&Object(f.c)("div",{css:{alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"flex-end"},children:[null!=c&&Object(f.b)(D.g,{appearance:"primary",css:{"&:hover":{backgroundColor:"transparent",border:"none",textDecoration:"underline",textDecorationColor:i.a.colors.blueDarkText},backgroundColor:"transparent",border:"none",height:i.a.sizing.small,marginRight:i.a.spacing.xsmall,padding:"".concat(i.a.spacing.xsmall," ").concat(i.a.spacing.small),span:{color:i.a.colors.blueDarkText}},intent:"neutral",onClick:function(e){a(""),c(e)},size:"small",children:"Cancel"}),Object(f.b)(D.g,{appearance:"primary",css:{height:i.a.sizing.small,padding:"".concat(i.a.spacing.xsmall," ").concat(i.a.spacing.small)},disabled:""===s,intent:"success",onClick:l,size:"small",children:"Send"})]})]})},Ce=function(e){var t=e.children,n=Object(N.b)(),a=Object(E.a)(Object(E.a)({},n),{},{autocompleteTriggers:{}});return Object(f.b)(N.a,{value:a,children:t})},_e=function(e){var t,n=e.autoFocus,a=void 0!==n&&n,s=e.channel,o=e.messages,c=void 0===o?[]:o,r=e.onCancelMessageInput,l=e.showControls,d=e.cellId,u=e.workspaceId,b=Object(m.useState)(!0),p=Object(C.a)(b,2),g=p[0],h=p[1],j=Object(me.a)(),O=Object(m.useMemo)((function(){return c.reduce((function(e,t){var n,a=null===(n=t.user)||void 0===n?void 0:n.image;return null==a||e.includes(a)?e:[].concat(Object(P.a)(e),[a])}),[]).slice(0,5)}),[c]),v=Object(m.useMemo)((function(){return c.filter((function(e){return null==e.deleted_at}))}),[c]),x=Object(m.useCallback)((function(e,t){return null!=t.id&&H.a.commenting.notifyUsersOfComment({body:{cellId:d,messageId:t.id,workspaceId:u}}).then((function(e){F.b.isLeft(e)&&G.b.captureMessage("Failed to notify users of comment: ".concat(e.left.errorType))})),window.dcmfeSnowplow("trackStructEvent",{action:"create-comment",category:"commenting",label:"mfe-app-workspace",property:u}),s.sendMessage(t)}),[s,d,u]);if(!j.canComment)return null;var y=null==s.id||!0!==(null===(t=j.channelsSettings[s.id])||void 0===t?void 0:t.hide);return Object(f.b)(we,{onCancelMessageInput:r,showControls:l,children:Object(f.b)(A.a,{Input:ke,Message:ve,TriggerProvider:Ce,channel:s,doSendMessageRequest:x,children:Object(f.c)("div",{css:{backgroundColor:i.a.colors.greySubtle,border:"".concat(i.a.borderWidth.thin," solid ").concat(i.a.colors.greyMedium),borderRadius:i.a.borderRadius.medium,fontSize:i.a.fontSizes.medium,marginTop:i.a.spacing.small,padding:i.a.spacing.small,ul:{listStyleType:"none",margin:0,padding:0}},children:[Object(f.b)("div",{css:{display:y?"block":"none"},children:c.length<=3||!g?Object(f.b)(B.a,{disableDateSeparator:!0,hideDeletedMessages:!0,messages:c,noGroupByUser:!0}):Object(f.c)(f.a,{children:[Object(f.b)(B.a,{disableDateSeparator:!0,hideDeletedMessages:!0,messages:c.slice(0,1),noGroupByUser:!0}),Object(f.b)(D.g,{appearance:"primary",css:{"&:hover":{backgroundColor:"transparent",border:"none",span:{color:i.a.colors.blue}},backgroundColor:"transparent",border:"none",height:i.a.sizing.small,marginBottom:i.a.spacing.small,marginRight:i.a.spacing.xsmall,padding:0,span:{color:i.a.colors.blueDarkText},textTransform:"none"},intent:"neutral",onClick:function(){return h(!1)},size:"small",children:"Show ".concat(c.length-3," more ").concat(c.length-3===1?"reply":"replies")}),Object(f.b)(B.a,{disableDateSeparator:!0,hideDeletedMessages:!0,messages:c.slice(c.length-2),noGroupByUser:!0})]})}),(0===v.length||y)&&Object(f.b)(W.a,{additionalTextareaProps:{maxLength:j.maxMessageLength},disableMentions:!0,focus:a,grow:!0}),Object(f.c)("div",{css:{display:v.length>0?"flex":"none",height:20,justifyContent:"center",marginTop:y?i.a.spacing.xsmall:0,paddingLeft:null==O||y?0:6*O.length,width:"100%"},children:[!y&&Object(f.b)("div",{css:{display:"flex"},children:O.map((function(e){return Object(f.b)(U.a,{avatar:Object(R.a)(e),css:{display:"relative",margin:"0 6px ".concat(i.a.spacing.small," -13px"),position:"relative"},dimensions:20},e)}))}),Object(f.b)(D.g,{css:{":hover":{backgroundColor:"transparent",span:{textDecoration:"underline"}},border:"none",padding:0,span:{color:i.a.colors.blueDarkText},textTransform:"none"},onClick:function(){return null!=s.id&&j.hideChannel(s.id,y)},children:"".concat(y?"Hide":"Show"," discussion")})]})]})})})},Ie=function(e){var t=e.color;return{border:"".concat(i.a.borderWidth.thin," solid ").concat(t),borderRadius:i.a.borderRadius.medium,margin:"-".concat(i.a.spacing.small),padding:i.a.spacing.small}},Se=function(e){var t,n,a=e.cellId,s=e.channel,o=e.children,c=e.messages,r=e.workspaceId,l=Object(m.useState)(!1),d=Object(C.a)(l,2),u=d[0],b=d[1],p=Object(m.useRef)(null),g=Object(me.a)();return Object(T.a)((function(){return setTimeout((function(){return b(!1)}),150)}),{refs:[p]}),Object(f.c)("div",{css:{":hover":{".commentButton":{visibility:"visible"}},alignItems:"flex-start",display:"flex",position:"relative"},ref:p,children:[Object(f.c)("div",{css:[Ie({color:u?i.a.colors.blueDark:"transparent"}),{":hover":u?void 0:Ie({color:i.a.colors.greyMedium}),position:"relative",width:"100%"}],children:[o,Object(f.b)("div",{css:{display:u||c.length>0?"block":"none"},onClick:function(e){Object(z.b)(e)||b(!0)},children:Object(f.b)(_e,{autoFocus:u,cellId:a,channel:s,messages:c,onCancelMessageInput:function(e){Object(z.a)(e),b(!1)},showControls:u,workspaceId:r},s.id)})]}),Object(f.b)("div",{css:(t={},Object(I.a)(t,L.r.veryLarge,{right:"-22px"}),Object(I.a)(t,L.r.smartphone,{right:0}),Object(I.a)(t,"height","100%"),Object(I.a)(t,"position","absolute"),Object(I.a)(t,"right","-136px"),t),children:Object(f.c)("div",{className:"commentButton",css:{":hover":{background:i.a.colors.grey,borderRadius:i.a.borderRadius.medium,button:{background:"transparent",boxShadow:"none",color:i.a.colors.blueDarkText}},alignItems:"center",cursor:"pointer",display:"flex",position:"sticky",top:130,visibility:"hidden"},onClick:function(){b((function(e){return!e})),g.canComment&&null!=s.id&&g.hideChannel(s.id,!1)},children:[Object(f.b)(D.g,{ariaLabel:"Add a comment",css:{backgroundColor:i.a.colors.white,border:"none",boxShadow:"0 0 0 1px ".concat(Object(M.d)(i.a.colors.navy,i.a.opacity.low)),color:i.a.colors.blueDarkText,height:i.a.sizing.small,padding:"7px 6px",transition:"none",width:i.a.sizing.small},type:"submit",children:Object(f.b)(S.a,{})}),Object(f.b)("span",{css:(n={},Object(I.a)(n,L.r.veryLarge,{display:"none"}),Object(I.a)(n,"fontSize",i.a.fontSizes.small),Object(I.a)(n,"padding","0 ".concat(i.a.spacing.small)),n),children:"Add comment"})]})})]})},De=function(){},Me=function(e){var t=e.cellId,n=e.channels,a=e.children,s=e.client,o=e.workspaceId,c=Object(m.useState)(),r=Object(C.a)(c,2),l=r[0],i=r[1],d=Object(m.useState)([]),u=Object(C.a)(d,2),b=u[0],p=u[1],g=Object(m.useCallback)((function(){var e;return p(null!==(e=null===l||void 0===l?void 0:l.state.messages)&&void 0!==e?e:[])}),[l]);return Object(m.useEffect)((function(){var e=n.find((function(e){return e.id===Object(_.a)({cellId:t,workspaceId:o})}));if(i(e),null==e)return De;i(e),p(e.state.messages);var a=function(t){"message.new"!==t.type&&"message.deleted"!==t.type&&"message.updated"!==t.type||t.channel_id===e.id&&g()};return s.on(a),function(){return s.off(a)}}),[n,s,o,t,g]),null==l?Object(f.b)(f.a,{children:a}):Object(f.b)(Se,{cellId:t,channel:l,messages:b,workspaceId:o,children:a})},Te=function(e){var t=e.cellId,n=e.children,a=e.workspaceId,s=Object(me.a)();return s.canComment&&null!=s.channels&&null!=a?Object(f.b)(Me,{cellId:t,channels:s.channels,client:s.client,workspaceId:a,children:n}):Object(f.b)(f.a,{children:n})},Le=n("./src/publicationView/usePublicationView.ts"),ze=n("./src/reducer.ts"),Pe=n("./src/notebookViewer/media/index.ts");t.default=function(e){var t=e.className,n=e.notebook,a=e.workspaceId,s=Object(ze.c)(Le.a),o=Object(m.useMemo)((function(){if(null!=a){var e=s[a];return"succeeded"===(null===e||void 0===e?void 0:e.status)?e.data.language:void 0}}),[s,a]);return Object(xe.jsx)(k,{CellWrapper:Te,Markdown:Pe.a,className:t,notebook:n,sentryClient:G.b,syntaxHighlighterLanguage:o,workspaceId:a})}}}]);
//# sourceMappingURL=90.831d1165.chunk.js.map